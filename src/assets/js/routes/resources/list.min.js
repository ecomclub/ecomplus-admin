!function(){"use strict";var n=window.tabId,m=window.Tabs[n],c=$("#t"+n+"-tab-normal");window.renderContentIds(c);var w=window.i18n,t=$("#app-tab-"+n),d="/"+window.location.hash+"/";$("#t"+n+"-create").click(function(){window.location=d+"new"});var e,f,p=m.slug,o=function(){e=m.data,f=e.result.map(function(t,e){var a={_index:e};for(var n in t){var i=t[n];if(null!==i&&Array.isArray(i))for(var s=0;s<i.length;s++)for(var r in i[s])i[s].hasOwnProperty(r)&&(a[n+"/"+r]=i[s][r]);if("object"!=typeof i||null===i||Array.isArray(i))a[n]=i;else for(r in i)i.hasOwnProperty(r)&&(a[n+"/"+r]=i[r])}return a})};if(o(),f.length){var u,b='<div class="custom-controls-stacked"><div class="custom-control custom-checkbox"><input type="checkbox" class="custom-control-input" /><label class="custom-control-label"> </label></div></div>',h=$("#t"+n+"-resource-list"),y=0,k=0;if(u=e.meta.hasOwnProperty("limit")?e.meta.limit:1e3,"orders"===p){h.before('<div class="flexbox mb-20 pull-right"><div class="dropdown" id="orders-bulk-action">    <button class="btn btn-success order-selected" id="orders-selected" type="button" data-toggle="">      <i class="fa fa-pencil"></i>      <span class="i18n">        <span data-lang="en_us">          Shipping <span class="hidden-md-down">tags</span>        </span>        <span data-lang="pt_br">          Etiquetas <span class="hidden-md-down">de envio</span>        </span>      </span>    </button>    <div class="dropdown-menu">      <a href="javascript:;" class="dropdown-item" id="correios">        <span class="i18n">          <span data-lang="en_us">Shipping tag</span>          <span data-lang="pt_br">Etiqueta dos correios</span>        </span>      </a>      <a href="javascript:;" id="standart" class="dropdown-item">        <span class="i18n">          <span data-lang="en_us">Standart tag</span>          <span data-lang="pt_br">Etiqueta padrão</span>        </span>      </a>    </div>  </div></div>');var a=t.find("#orders-selected");a.click(function(){0<!m.selectedItems.length?app.toast(w({en_us:"No orders selected",pt_br:"Nenhum pedido selecionado"})):a.attr("data-toggle","dropdown")}),t.find("#correios").click(function(){1===m.selectedItems.length?window.location.href="/#/tag/"+m.selectedItems[0]:4<m.selectedItems.length?app.toast(w({en_us:"Only 4 orders allowed",pt_br:"Apenas 4 pedidos permitidos"})):window.location.href="/#/tag/"+m.selectedItems}),t.find("#standart").click(function(){m.selectedItems.length<10?window.location.href="/#/tagstandart/"+m.selectedItems:app.toast(w({en_us:"Only 9 orders allowed",pt_br:"Apenas 9 pedidos permitidos"}))})}var v={},_="updated_at",x="desc",T={field:_,order:x},i=function(t){("number"!=typeof t||isNaN(t)||t<1)&&(t=1),k=(t-1)*u,j()},s=function(t){var e=$("#t"+n+"-page"),a=parseInt(e.val(),10)+t;0<a&&(i(a),e.val(a))},I=function(){var t=$("#t"+n+"-prev"),e=$("#t"+n+"-next"),a=$("#t"+n+"-page");k<=0?t.attr("disabled",!0):t.removeAttr("disabled"),f.length<u?e.attr("disabled",!0):e.removeAttr("disabled"),k<=0&&f.length<u?a.attr("disabled",!0):a.removeAttr("disabled"),a.val(Math.ceil(k/u)+1)};$("#t"+n+"-page").keydown(window.keyIsNumber).change(function(){i(parseInt($(this).val(),10))}),$("#t"+n+"-next").click(function(){s(1)}),$("#t"+n+"-prev").click(function(){s(-1)}),I(),m.pagination=function(t){s(t?-1:1)},$("#t"+n+"-page-size").change(function(){var t=parseInt($(this).val(),10);!isNaN(t)&&0<t&&(u=t,k=0,$("#t"+n+"-page").val("1")),j()});var O=!1,A=!1,l=!1,g=!1,j=function(e){if(l)g||(g=!0);else{var a;l=!0,e||(a=h.find(".loading")).show();var t="limit="+u;0<k&&(t+="&offset="+k),T.field&&(t+="&sort=","desc"===T.order&&(t+="-"),t+=T.field.replace("/","."));for(var n=0;n<P.length;n++){var i=P[n],s=v[i];if(s&&""!==s){var r=i.replace("/",".");/([0-9]+)?>>([0-9]+)?/.test(s)?(""!==(s=s.split(">>"))[0]&&(t+="&"+r+">="+s[0]),""!==s[1]&&(t+="&"+r+"<="+s[1])):t+="&"+r+"="+s}}m.load(function(t){l=!1,"function"!=typeof e?(a.fadeOut(),g&&(j(),g=!1),t||(o(),O=!0,h.jsGrid("loadData"),I())):e()},t)}},N=!1,S=$("<i>",{click:function(){h.jsGrid("loadData")}}),D=function(){S.attr("class","fa fa-"+(N?"pencil text-primary":"search")),h.find(".data-list-range").attr("disabled",N)};D(),m.editItemsCallback=function(){return h.find(".loading").show(),function(){O=!(A=!0),h.jsGrid(N?"clearFilter":"loadData"),h.find(".checkbox-all:checked").next().click(),N=!1,D()}};var E=[],P=[],C=[];$.getJSON("json/misc/config_lists.json",function(i){var g=i[p];if(g){E.push({align:"center",css:"data-list-check",filtering:!1,sorting:!1,headerTemplate:function(){var t=$(b);return t.find("input").addClass("checkbox-all").on("change",function(){var t=$(this).is(":checked")?":not(:checked)":":checked",e=h.find(".loading");return e.show(),setTimeout(function(){h.find(".data-list-check input"+t).next().click(),e.hide()},50),!0}),t},filterTemplate:function(){var t=$("<div>",{class:"data-list-control-buttons",html:[S,$("<i>",{class:"fa fa-filter",click:function(){h.jsGrid("clearFilter")}})]});return $("<div>",{class:"data-list-control",html:[t,'<div class="spinner-circle-shadow loading"></div>']})},itemTemplate:function(t,e){var a=$(b),n=e._id,i=a.find("input");-1<$.inArray(n,m.selectedItems)&&i.prop("checked",!0),y++,a.attr("title","#"+(k+y)),i.on("change",function(){var e,t;$(this).is(":checked")?(t=n,m.selectedItems.push(t),N||(N=!0,D())):(e=n,m.selectedItems=$.grep(m.selectedItems,function(t){return t!==e}),!m.selectedItems.length&&N&&(N=!1,D()))});var s=g._hidden_fields;if(!s)return a;for(var r=[],o=0;o<s.length;o++){var l=s[o];if(void 0!==e[l])if(Array.isArray(e[l])){if(g[l]&&g[l].template)for(var c=0;c<e[l].length;c++){var d=e[l][c],f=g[l].template;for(var p in d)if(d.hasOwnProperty(p)){var u=new RegExp("{{"+p+"}}","g");f=f.replace(u,d[p])}f=f.replace(/{{\S+}}/g," - "),r.push($("<div>",{html:f}))}}else{var h=e[l];"money"===g[l].type?h=formatMoney(h):"boolean"==typeof h&&(h=w(h)),r.push($("<span>",{text:w(g[l].label)+": "+h}))}}var v=$("<div>",{class:"data-list-accordion",html:r});return $("<div>",{class:"data-list-extend",html:[a,$("<i>",{class:"ti-angle-down"}).one("click",function(){$(this).closest("tr").append(v)}).click(function(t){t.stopPropagation();var e=$(this);v.slideToggle(400,function(){e.attr("class",$(this).is(":visible")?"ti-angle-up":"ti-angle-down")})})]})}});for(var s=function(t,s){t.filterTemplate=function(){var a=$("<input>",{type:"hidden"}),t=function(){var t=n.data("value")||n.val()||"",e=i.data("value")||i.val()||"";a.val(""!==t||""!==e?t+">>"+e:""),h.jsGrid("loadData")};this.filterControl=a;var e={class:"data-list-range",keydown:function(t){switch(t.which){case 13:$(this).trigger("change")}},type:"tel",placeholder:w({en_us:"min",pt_br:"mín"})},n=$("<input>",e),i=$("<input>",Object.assign(e,{placeholder:w({en_us:"max",pt_br:"máx"})}));return"function"==typeof s&&(s(n,0),s(i,1)),n.change(t),i.change(t),$("<div>",{html:[n,i]})}},t=0;t<g._fields.length;t++){var e=g._fields[t],a=g[e]||{};P.push(e);var r={name:e,type:"text",title:w(a.label||i._labels[e])};if(0===t)"_id"!==e?r.itemTemplate=function(t,e){if(t&&e)return $("<a>",{text:t,href:d+e._id})}:(r.itemTemplate=function(t){if(t)return $("<a>",{text:"#"+y,href:d+t})},r.title="#",r.filtering=!1,r.sorting=!1,a.width=60);else switch(a.templates&&(r.itemTemplate=function(t){if(t)return t}),a.type){case"link":r.itemTemplate=function(t){if(t){var e=t.length;return $("<a>",{text:32<e?t.substr(0,12)+"..."+t.substr(e-20):t,href:-1===t.indexOf("@")?t:"mailto:"+t,target:"_blank"})}};break;case"bold":!function(t,n,i){var s=function(t){var e=i[t]||{},a=n+" text-"+(e.class||"muted");return $("<span>",{class:a,text:w(e.text)||t})};r.itemTemplate=function(t){if(void 0!==t)return s("string"==typeof t?t:t.toString())},r.filterTemplate=function(){var t=[$("<option>",{text:"--",value:"",selected:!0})];for(var e in i)i.hasOwnProperty(e)&&t.push($("<option>",{text:e,value:e,"data-content":s(e).prop("outerHTML")}));var a=$("<select>",{class:"hidden",html:t,change:function(){h.jsGrid("loadData")}});return this.filterControl=a,setTimeout(function(){a.selectpicker({noneSelectedText:"--",windowPadding:70,container:c})},200),a}}(0,a.type,a.enum);break;case"money":r.itemTemplate=function(t){return formatMoney(t)},s(r,function(t){t.inputMoney(!0),t.change(function(){$(this).data("value",stringToNumber($(this).val()))})})}a.cut_string&&function(i){var s=r.itemTemplate;r.itemTemplate=function(t,e){if(t){var a="function"==typeof s?s(t,e):t;if(t.length>=i){var n='<abbr title="'+t+'">'+cutString(t,i)+"</abbr>";"string"!=typeof a?a.html(n):a.replace(t,n)}return a}}}(a.cut_string),a.width&&(r.css="data-list-fixed",r.width=a.width),a.range?s(r):C.push(e),E.push(r),!1!==r.filtering&&(v[e]="")}}var n=function(t,a,n){v[t]="",P.push(t);var e={name:t,type:"text",title:w(i._labels[t]),css:"data-list-fixed",width:n?110:90,itemTemplate:function(t){var e=t?formatDate(t,a):t;return n?$("<span>",{text:e,class:"fw-400"}):e}};return s(e,function(e,a){e.change(function(){var t=$(this).datepicker("getDate");t&&!isNaN(t.getTime())&&(1===a&&t.setHours(23,59,59),$(this).data("value",t.toISOString()))}),1===a&&setTimeout(function(){var t=e.parent();t.datepicker({inputs:t.children("input")})},300)}),e},o=n("created_at"),l=n("updated_at",["day","month","hour","minute"],!0);E.push(o,l),h.jsGrid({autoload:!0,filtering:!0,sorting:!0,confirmDeleting:!1,pageLoading:!0,pageSize:u,rowClick:function(t){var e=t.event.originalEvent||t.event;if(e){var a=e.target;if(a)switch(a.nodeName){case"TD":for(var n=0;n<a.classList.length;n++)if("data-list-check"===a.classList[n])return void $(a).find("label").click();break;case"LABEL":case"INPUT":case"DIV":case"SELECT":case"A":case"ABBR":return}}var i=t.item;window.location=d+i._id,u=1,m.state.page=k+i._index,m.state.pagination=function(t){-1<(k=m.state.page+(t?-1:1))&&(m.state.page=k,j(function(){var t=m.data.result;t&&t.length&&(window.location=d+t[0]._id)}))}},controller:{loadData:function(t){if(O)O=!1;else if(A)j(),A=!1;else{var e,a=!1,n=!1;if(N){for(var i={},s=0;s<C.length;s++)if(""!==t[e=C[s]]){switch(t[e]){case"true":t[e]=!0;break;case"false":t[e]=!1}var r=e.split("/"),o=r[0];if(1<r.length){i[o]={};for(var l=1,c=i[o];l<r.length-1;)c[r[l]]={},l++;c[r[l]]=t[e]}else i[o]=t[e]}Object.keys(i).length&&(m.editItems(i),n=!0)}else for(e in v)v.hasOwnProperty(e)&&t[e]!==v[e]&&(v[e]=t[e],a||(a=!0));t.sortField||(t.sortField=_,t.sortOrder=x),T.field===t.sortField&&T.order===t.sortOrder||(T.field=t.sortField,T.order=t.sortOrder,a||(a=!0)),a?(k=0,I(),j()):N&&!n&&app.toast(w({en_us:"Edit the header fields to modify the selected items",pt_br:"Edite os campos no cabeçalho para alterar os itens selecionados"}))}return{data:f,itemsCount:f.length}}},onRefreshing:function(){y=0},fields:E})})}setTimeout(function(){window.unsetSaveAction()},200)}();